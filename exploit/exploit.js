// exploit.js

const exploitBody = document.getElementById("exploitBody");
const exploitForm = document.getElementById("exploitForm");
const logsBtn = document.getElementById("logsBtn");

// 동적 호스트/포트
const protocol = window.location.protocol;
const host = window.location.hostname;

const mainServerUrl = `${protocol}//${host}:5000`;   // Flask 메인 서버
const siblingLoginUrl = `${protocol}//${host}:5001`; // Sibling 로그인 서버

// Exploit 전달
exploitForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const payload = exploitBody.value.trim();
    if (!payload) return;

    try {
        await fetch(`${mainServerUrl}/deliver`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ payload })
        });
    } catch (err) {
        console.error("Error delivering exploit:", err);
    }
});

// Logs 버튼
logsBtn.addEventListener("click", () => {
    console.log("Logs button clicked");   // 디버깅용
    const logsUrl = `${protocol}//${host}:8000/logs`;
    window.open(logsUrl, "_blank");
});
